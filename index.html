<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <title>BuzdolabÄ± Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#667eea" />
    <meta name="description" content="BuzdolabÄ± sÄ±caklÄ±k takip sistemi" />
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json" />
    <!-- CSS -->
    <link rel="stylesheet" href="style.css" />
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  </head>

  <body>
    <!-- Dark Mode Toggle -->
    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
      ğŸŒ™
    </button>
    <!-- PWA Install Prompt -->
    <div class="install-prompt" id="installPrompt">
      <span style="color: var(--text-primary)"
        >ğŸ“± Ana ekrana ekle ve uygulama gibi kullan!</span
      >
      <button id="installBtn">Kur</button>
      <button class="close-btn" id="closeInstallBtn">Ã—</button>
    </div>
    <div class="container">
      <!-- BaÄŸlantÄ± Durum Ã‡ubuÄŸu -->
      <div class="status-bar">
        <div class="connection-status">
          <div class="status-indicator">
            <div class="status-dot online" id="statusDot"></div>
            <span id="statusText">BaÄŸlantÄ± Kuruluyor...</span>
          </div>
          <div class="last-update" id="lastUpdateText">Son gÃ¼ncelleme: --</div>
        </div>
        <!-- Elektrik Kesintisi UyarÄ±sÄ± -->
        <div class="alert danger" id="powerAlert">
          <strong>âš ï¸ Elektrik Kesintisi Tespit Edildi!</strong><br />
          Son veri: <span id="powerAlertTime">--</span> Ã¶nce alÄ±ndÄ±.
        </div>
        <!-- BaÄŸlantÄ± Yeniden Kuruldu -->
        <div class="alert success" id="reconnectAlert">
          <strong>âœ“ BaÄŸlantÄ± Yeniden Kuruldu!</strong><br />
          Elektrik kesintisi sÃ¼resi: <span id="outageDuration">--</span>
        </div>
      </div>

      <!-- AnlÄ±k SÄ±caklÄ±klar - Ortam SÄ±caklÄ±ÄŸÄ± - Derin Dondurucu -->
      <div class="grid">
        <!-- Ortam SÄ±caklÄ±ÄŸÄ± -->
        <div class="card">
          <h1>ğŸŒ¡ï¸ Ortam SÄ±caklÄ±ÄŸÄ±</h1>
          <div class="temp" id="room-temp">--</div>
          <div class="timestamp" id="room-time">Bekleniyor...</div>
          <div class="sensor-status ok" id="room-status">Veri Bekleniyor</div>
        </div>
        <!-- Derin Dondurucu -->
        <div class="card">
          <h1>â„ï¸ Derin Dondurucu</h1>
          <div class="temp" id="deep-freezer-temp">--</div>
          <div class="timestamp" id="deep-freezer-time">Bekleniyor...</div>
          <div class="sensor-status ok" id="deep-freezer-status">
            Veri Bekleniyor
          </div>
        </div>
      </div>

      <!-- AnlÄ±k SÄ±caklÄ±klar - BuzdolabÄ± - Dondurucu -->
      <div class="grid">
        <!-- Normal Dolap -->
        <div class="card">
          <h1>ğŸ§Š Normal Dolap</h1>
          <div class="temp" id="fridge-temp">--</div>
          <div class="timestamp" id="fridge-time">Bekleniyor...</div>
          <div class="sensor-status ok" id="fridge-status">Veri Bekleniyor</div>
        </div>
        <!-- Dondurucu -->
        <div class="card">
          <h1>â„ï¸ Dondurucu</h1>
          <div class="temp" id="freezer-temp">--</div>
          <div class="timestamp" id="freezer-time">Bekleniyor...</div>
          <div class="sensor-status ok" id="freezer-status">
            Veri Bekleniyor
          </div>
        </div>
      </div>

      <!-- 24 Saatlik Grafik -->
      <div class="card full-width">
        <h2>ğŸ“Š Son 24 Saat - SÄ±caklÄ±k DeÄŸiÅŸimi</h2>
        <div class="chart-container">
          <canvas id="temperatureChart"></canvas>
        </div>
        <p
          id="chartMessage"
          style="
            text-align: center;
            color: var(--text-secondary);
            padding: 20px;
          "
        >
          ğŸ“Š Veriler toplanÄ±yor... Ä°lk grafikler 1 saat iÃ§inde oluÅŸacak.
        </p>
      </div>
      <!-- Ä°STATÄ°STÄ°KLER BÃ–LÃœMÃœ (Grafikten sonra eklenecek) -->
      <!-- GÃ¼nlÃ¼k Ä°statistikler -->
      <div class="stats-grid">
        <!-- Normal Dolap Ä°statistikleri -->
        <div class="card stat-card" id="fridge-stats">
          <h3>ğŸ§Š Normal Dolap - BugÃ¼n</h3>
          <div class="stat-item">
            <span class="stat-label">ğŸ“‰ Minimum:</span>
            <span class="stat-value" id="fridge-min">--</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">ğŸ“ˆ Maksimum:</span>
            <span class="stat-value" id="fridge-max">--</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">ğŸ“Š Ortalama:</span>
            <span class="stat-value" id="fridge-avg">--</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">ğŸ”¢ Ã–lÃ§Ã¼m SayÄ±sÄ±:</span>
            <span class="stat-value" id="fridge-count">--</span>
          </div>
        </div>
        <!-- Dondurucu Ä°statistikleri -->
        <div class="card stat-card" id="freezer-stats">
          <h3>â„ï¸ Dondurucu - BugÃ¼n</h3>
          <div class="stat-item">
            <span class="stat-label">ğŸ“‰ Minimum:</span>
            <span class="stat-value" id="freezer-min">--</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">ğŸ“ˆ Maksimum:</span>
            <span class="stat-value" id="freezer-max">--</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">ğŸ“Š Ortalama:</span>
            <span class="stat-value" id="freezer-avg">--</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">ğŸ”¢ Ã–lÃ§Ã¼m SayÄ±sÄ±:</span>
            <span class="stat-value" id="freezer-count">--</span>
          </div>
        </div>
      </div>
      <!-- Elektrik Kesintisi GeÃ§miÅŸi -->
      <div class="card full-width">
        <h2>âš¡ Elektrik Kesintisi GeÃ§miÅŸi (Son 7 GÃ¼n)</h2>
        <div id="outageHistory">
          <p
            style="
              color: var(--text-secondary);
              text-align: center;
              padding: 20px;
            "
          >
            HenÃ¼z kesinti kaydÄ± yok
          </p>
        </div>
      </div>
      <!-- HaftalÄ±k Ã–zet -->
      <div class="card full-width weekly-summary">
        <h2>ğŸ“… HaftalÄ±k Ã–zet (Son 7 GÃ¼n)</h2>
        <div class="summary-grid">
          <div class="summary-item">
            <div class="summary-icon">ğŸ§Š</div>
            <div class="summary-content">
              <div class="summary-label">Normal Dolap Ort.</div>
              <div class="summary-value" id="weekly-fridge-avg">--</div>
            </div>
          </div>
          <div class="summary-item">
            <div class="summary-icon">â„ï¸</div>
            <div class="summary-content">
              <div class="summary-label">Dondurucu Ort.</div>
              <div class="summary-value" id="weekly-freezer-avg">--</div>
            </div>
          </div>
          <div class="summary-item">
            <div class="summary-icon">âš¡</div>
            <div class="summary-content">
              <div class="summary-label">Toplam Kesinti</div>
              <div class="summary-value" id="weekly-outage-count">--</div>
            </div>
          </div>
          <div class="summary-item">
            <div class="summary-icon">â±ï¸</div>
            <div class="summary-content">
              <div class="summary-label">Toplam Kesinti SÃ¼resi</div>
              <div class="summary-value" id="weekly-outage-duration">--</div>
            </div>
          </div>
        </div>
      </div>
      <!-- Yenile Butonu -->
      <button class="refresh-btn" onclick="refreshData()">
        ğŸ”„ Verileri Yenile
      </button>
    </div>
    <!-- JavaScript -->
    <script src="app.js"></script>
  </body>
</html>
